"use strict";(self.webpackChunk_prifina_widgets_prifina_kpi=self.webpackChunk_prifina_widgets_prifina_kpi||[]).push([[104],{3104:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var n=a(1746),o=a(929),l=a(4315),r=(a(9120),a(5713),a(8188),a(3439),a(8695),a(1939),a(6936),a(8178),a(9949),a(4226),a(2501),a(7900)),c=a.n(r),i=a(2734),m=a(7899),s=(a(1244),a(2415)),d=a(5523),p=a(1613),u=a(6546),h=function(e){var t=e.size,a=e.data,h=(0,i.usePrifina)().onUpdate,f=(0,r.useState)([]),g=(0,l.Z)(f,2),w=g[0],E=g[1],x=(0,r.useState)([]),k=(0,l.Z)(x,2),v=k[0],y=k[1],b=(0,r.useState)([]),D=(0,l.Z)(b,2),_=D[0],Z=D[1],S=(0,r.useState)([]),N=(0,l.Z)(S,2),j=N[0],T=N[1],z=(0,r.useState)(),C=(0,l.Z)(z,2),P=C[0],I=C[1],K=(0,r.useState)(0),O=(0,l.Z)(K,2),F=O[0],R=O[1],A=(0,r.useState)(0),B=(0,l.Z)(A,2),W=B[0],q=B[1],L=(0,r.useState)([]),U=(0,l.Z)(L,2),X=U[0],G=U[1],H=(0,r.useState)(!1),J=(0,l.Z)(H,2),M=J[0],Q=J[1],V=(0,r.useState)(!1),Y=(0,l.Z)(V,2),$=(Y[0],Y[1]),ee=new Date,te=ee.setDate(ee.getDate()),ae=new Date(te).toISOString().split("T")[0],ne=t;void 0!==a&&a.hasOwnProperty("settings")&&"object"===(0,o.Z)(a.settings)&&a.settings.hasOwnProperty("size")&&a.settings.size.length>0&&(ne=a.settings.size);var oe=(0,r.useState)(ne),le=(0,l.Z)(oe,2),re=(le[0],le[1]),ce=function(e){console.log("Data Update",e),e.hasOwnProperty("settings")&&"object"===(0,o.Z)(e.settings)&&e.settings.hasOwnProperty("size")&&re(e.settings.size)};(0,r.useEffect)((function(){h(m.A,ce),fetch("https://registry.npmjs.com/-/v1/search?text=@dynamic-data&size=1000").then((function(e){return e.json()})).then((function(e){return E(e.objects)}))}),[]),(0,r.useEffect)((function(){w.forEach((function(e){fetch("https://api.npmjs.org/downloads/point/last-week/".concat(e.package.name)).then((function(e){return e.json()})).then((function(e){return y((function(t){return[].concat((0,n.Z)(t),[e])}))}))})),w.forEach((function(e){fetch("https://registry.npmjs.org/".concat(e.package.name)).then((function(e){return e.json()})).then((function(e){return T((function(t){return[].concat((0,n.Z)(t),[e])}))}))}))}),[w]),(0,r.useEffect)((function(){v.length===w.length&&v.forEach((function(e){q((function(t){return t+e.downloads}))}))}),[v]),(0,r.useEffect)((function(){_.length===w.length&&_.forEach((function(e){R((function(t){return t+e.downloads}))}))}),[_]),(0,r.useEffect)((function(){j.length===w.length&&(console.log("packagesCreateData",j),j.forEach((function(e){var t=e.time.created.split("T")[0];fetch("https://api.npmjs.org/downloads/point/".concat(t,":").concat(ae,"/").concat(e.name)).then((function(e){return e.json()})).then((function(e){return Z((function(t){return[].concat((0,n.Z)(t),[e])}))}))})))}),[j]),(0,r.useEffect)((function(){w.length===v.length&&w.length===_.length&&(G([]),console.log("data",w),console.log("weeklyDownloads",v),console.log("allTimeDownloads",_),v.forEach((function(e){var t={},a=_.findIndex((function(t){return t.package===e.package}));t.packageName=e.package,t.weeklyDownloads=e.downloads,t.allDownloads=_[a].downloads,t.allDownloadsStartRange=_[a].start,t.allDownloadsEndRange=_[a].end,t.allDownloadsRange="".concat(_[a].start," / ").concat(_[a].end),console.log(),G((function(e){return[].concat((0,n.Z)(e),[t])}))})))}),[v,_]),(0,r.useEffect)((function(){w.length===X.length&&X.length>0&&setTimeout((function(){Q(!0)}),100)}),[X]);var ie=function(e){if(e){var t=e.packageName,a=e.allDownloadsStartRange;console.log(t,a);var n=new Date(a),o=n.setDate(n.getDate()-(n.getDay()+6)%7),l=new Date(o).toISOString().split("T")[0];fetch("https://api.npmjs.org/downloads/range/".concat(l,":").concat(ae,"/").concat(t)).then((function(e){return e.json()})).then((function(t){return me(t,e)}))}else I();$((function(e){return!e}))},me=function(e,t){console.log(e);for(var a=e.downloads,n=[],o=function(e){var t={},o=a.slice(e,e+7),l=0;o.forEach((function(e){l+=e.downloads})),t.totalDownloads=l,t.dateSpan="".concat(o[0].day," / ").concat(o[o.length-1].day),n.push(t)},l=0;l<a.length;l+=7)o(l);var r={packageInfo:t,package:e.package,chartData:n};console.log(r),I(r)};return c().createElement("div",{className:"container"},M?c().createElement("div",null,P&&c().createElement(u.Z,{chartData:P,handleChart:ie}),c().createElement(s.Z,{allTimeTotal:F,weeklyTotal:W}),c().createElement("hr",null),c().createElement(d.Z,{packages:X,handleChart:ie})):c().createElement(p.Z,null))};h.defaultProps={size:"small"};const f=h},6546:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(4315),o=(a(9120),a(8188),a(3439),a(8178),a(3450),a(2501),a(7900)),l=a.n(o),r=a(3258),c=a(441),i=a(5484),m=a(3131),s=a(5556),d=a(2655),p=a(3164),u=a(1573);const h=function(e){var t=e.chartData,a=e.handleChart,h=(0,o.useState)("weekly"),f=(0,n.Z)(h,2),g=f[0],w=f[1],E=(0,o.useState)(),x=(0,n.Z)(E,2),k=x[0],v=x[1],y=(0,o.useState)(),b=(0,n.Z)(y,2),D=b[0],_=b[1],Z=(0,o.useState)(),S=(0,n.Z)(Z,2),N=S[0],j=S[1];(0,o.useEffect)((function(){Date.parse(k)<Date.parse(D)?(j(),fetch("https://api.npmjs.org/downloads/range/".concat(k,":").concat(D,"/").concat(t.packageInfo.packageName)).then((function(e){return e.json()})).then((function(e){return j(e)}))):j()}),[k,D]),(0,o.useEffect)((function(){console.log(N)}),[N]);var T=function(e){var t=e.active,a=e.payload;return e.label,t?l().createElement("div",{className:"chart-tooltip"},l().createElement("div",{className:"chart_custom_tooltip"},l().createElement("span",null,"Day: ",a[0].payload.dateSpan),l().createElement("span",null,"Downloads: ",a[0].payload.totalDownloads))):null},z=function(e){var t=e.active,a=e.payload;return e.label,t?l().createElement("div",{className:"chart-tooltip"},l().createElement("div",{className:"chart_custom_tooltip"},l().createElement("span",null,"Day: ",a[0].payload.day),l().createElement("span",null,"Downloads: ",a[0].payload.downloads))):null};return l().createElement("div",{className:"chart"},l().createElement("div",{className:"arrow_border",onClick:function(){return a()}},l().createElement("i",{className:"arrow left"})),l().createElement("select",{className:"select",onChange:function(e){return function(e){w(e.target.value)}(e)}},[{value:"weekly",label:"Weekly Downloads"},{value:"custom",label:"Custom Downloads"}].map((function(e){return l().createElement("option",{value:e.value,key:e.label},e.label)}))),"weekly"===g?l().createElement(l().Fragment,null,l().createElement("div",{className:"downloadsTitle"},l().createElement("h1",null,"Package: ",t.packageInfo.packageName.slice(13)),l().createElement("p",null,"Time Z Downloads: ",t.packageInfo.allDownloads),l().createElement("p",null,"This week Downloads: ",t.packageInfo.weeklyDownloads)),l().createElement("div",{className:"chart_viev"},l().createElement(r.h,{width:"100%",height:"85%"},l().createElement(c.w,{width:250,height:200,data:t.chartData,margin:{top:5,right:40,left:-10,bottom:10}},l().createElement(i.q,{strokeDasharray:"3 3"}),l().createElement(m.B,null),l().createElement(s.K,null),l().createElement(d.u,{content:l().createElement(T,null)}),l().createElement(p.B,{dataKey:"totalDownloads",height:20,stroke:"#8884d8"}),l().createElement(u.x,{dataKey:"totalDownloads",stroke:"#8884d8",name:"dateSpan"}))))):l().createElement(l().Fragment,null,l().createElement("div",{className:"downloadsTitle"},l().createElement("h1",null,"Package: ",t.packageInfo.packageName.slice(13)),l().createElement("p",null,"From:",l().createElement("input",{type:"date",onChange:function(e){return v(e.target.value)}})),l().createElement("p",null,"To:",l().createElement("input",{type:"date",onChange:function(e){return _(e.target.value)}}))),l().createElement("div",{className:"chart_viev"},N?l().createElement(r.h,{width:"100%",height:"85%"},l().createElement(c.w,{width:250,height:200,data:N.downloads,margin:{top:5,right:40,left:-10,bottom:10}},l().createElement(i.q,{strokeDasharray:"3 3"}),l().createElement(m.B,null),l().createElement(s.K,null),l().createElement(d.u,{content:l().createElement(z,null)}),l().createElement(p.B,{dataKey:"downloads",height:20,stroke:"#8884d8"}),l().createElement(u.x,{dataKey:"downloads",stroke:"#8884d8",name:"dateSpan"}))):l().createElement(l().Fragment,null,l().createElement("div",{className:"notification"},l().createElement("p",null,"Specify Data Range !"))))))}},1613:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(7900),o=a.n(n);function l(){return o().createElement("div",{className:"loading_screen"},o().createElement("span",{className:"loader"}),o().createElement("p",null,"Loading ..."))}},5523:(e,t,a)=>{a.d(t,{Z:()=>l}),a(3450),a(2501);var n=a(7900),o=a.n(n);function l(e){var t=e.packages,a=e.handleChart;return o().createElement("div",{className:"packages_list"},o().createElement("p",null,'"@dynamic-data" Packages: '),o().createElement("div",{className:"packages_list__scroll"},t.map((function(e){return o().createElement("p",{key:e.packageName,onClick:function(){return a(e)}},e.packageName.slice(13))}))))}},2415:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(7900),o=a.n(n);function l(e){var t=e.allTimeTotal,a=e.weeklyTotal;return o().createElement("div",{className:"total_Downloads"},o().createElement("p",null,"Last Week Downloads: ",a),o().createElement("p",null,"Time Z Downloads: ",t))}},7899:(e,t,a)=>{a.d(t,{A:()=>n});var n="njCrPXWhDtZF345bpZ39rmf"},1522:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(9601),o=a.n(n),l=a(2609),r=a.n(l)()(o());r.push([e.id,'.container{width:300px;height:300px;border:1px solid black;border-radius:10px;margin:10px}.notification p{text-decoration:underline}.loading_screen{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:30px;width:100%;height:100%}.loading_screen p{padding-top:20px;font-size:20px;font-weight:600}.total_Downloads{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;height:70px;width:100%;padding-top:25px}.total_Downloads p{font-size:20px;font-weight:600}.select{width:150px;position:absolute;top:25px;left:25%}.packages_list{display:flex;flex-direction:column;justify-content:center;align-items:center;height:190px;width:100%;gap:10px;padding-bottom:10px}.packages_list p{font-size:20px;font-weight:600}.packages_list__scroll{overflow:auto;height:170px;width:90%;display:flex;flex-direction:column}.packages_list__scroll p{padding:7px 0px 7px 15px}.packages_list__scroll p:hover{background-color:#afafaf}.chart{position:absolute;width:298px;height:298px;background-color:white;border-radius:10px;padding-top:10px;display:flex;flex-direction:column;gap:10px}.chart .downloadsTitle{display:flex;flex-direction:column;justify-content:center;align-items:center;height:35%;padding-top:50px}.chart .downloadsTitle h1{font-size:18px;font-weight:600;margin-bottom:5px}.chart .downloadsTitle p{font-size:16px;font-weight:400}.chart_viev{display:flex;justify-content:center;align-items:center;height:65%;width:100%;padding-bottom:5px}.chart_viev p:nth-child(1){padding-bottom:10px;font-size:20px;font-weight:500}.chart_custom_tooltip{display:flex;flex-direction:column;padding:10px;background-color:rgba(51,51,51,0.3)}.arrow{border:solid black 1px;border-width:0 2px 2px 0;display:inline-block;padding:3px;margin-left:2px}.arrow_border{content:"";position:absolute;display:flex;justify-content:center;align-items:center;margin:5px 12px;height:30px;width:31px;border:1px solid black;border-radius:50%}.left{transform:rotate(135deg)}.loader{color:#000;font-size:10px;width:1em;height:1em;border-radius:50%;position:relative;text-indent:-9999em;animation:mulShdSpin 1.3s infinite linear;transform:translateZ(0)}@keyframes mulShdSpin{0%,100%{box-shadow:0 -3em 0 0.2em, \r 2em -2em 0 0em, 3em 0 0 -1em, \r 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 -1em, -3em 0 0 -1em, \r -2em -2em 0 0}12.5%{box-shadow:0 -3em 0 0, 2em -2em 0 0.2em, \r 3em 0 0 0, 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 -1em, -3em 0 0 -1em, \r -2em -2em 0 -1em}25%{box-shadow:0 -3em 0 -0.5em, \r 2em -2em 0 0, 3em 0 0 0.2em, \r 2em 2em 0 0, 0 3em 0 -1em, \r -2em 2em 0 -1em, -3em 0 0 -1em, \r -2em -2em 0 -1em}37.5%{box-shadow:0 -3em 0 -1em, 2em -2em 0 -1em,\r 3em 0em 0 0, 2em 2em 0 0.2em, 0 3em 0 0em, \r -2em 2em 0 -1em, -3em 0em 0 -1em, -2em -2em 0 -1em}50%{box-shadow:0 -3em 0 -1em, 2em -2em 0 -1em,\r 3em 0 0 -1em, 2em 2em 0 0em, 0 3em 0 0.2em, \r -2em 2em 0 0, -3em 0em 0 -1em, -2em -2em 0 -1em}62.5%{box-shadow:0 -3em 0 -1em, 2em -2em 0 -1em,\r 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 0, \r -2em 2em 0 0.2em, -3em 0 0 0, -2em -2em 0 -1em}75%{box-shadow:0em -3em 0 -1em, 2em -2em 0 -1em, \r 3em 0em 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 0, -3em 0em 0 0.2em, -2em -2em 0 0}87.5%{box-shadow:0em -3em 0 0, 2em -2em 0 -1em, \r 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 0, -3em 0em 0 0, -2em -2em 0 0.2em}}\n',""]);const c=r},1244:(e,t,a)=>{var n=a(6062),o=a.n(n),l=a(4036),r=a.n(l),c=a(6793),i=a.n(c),m=a(7892),s=a.n(m),d=a(1173),p=a.n(d),u=a(2464),h=a.n(u),f=a(1522),g={};g.styleTagTransform=h(),g.setAttributes=s(),g.insert=i().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=p(),o()(f.Z,g),f.Z&&f.Z.locals&&f.Z.locals}}]);