"use strict";(self.webpackChunk_prifina_widgets_prifina_kpi=self.webpackChunk_prifina_widgets_prifina_kpi||[]).push([[470],{9470:(e,t,n)=>{n.r(t);var a=n(1746),o=n(929),l=n(4315),r=(n(9120),n(5713),n(8188),n(3439),n(8695),n(1939),n(6936),n(8178),n(9949),n(4226),n(2501),n(7900)),c=n.n(r),m=n(2734),i=n(6062),s=n.n(i),d=n(4036),p=n.n(d),u=n(6793),h=n.n(u),g=n(7892),f=n.n(g),w=n(1173),E=n.n(w),x=n(2464),k=n.n(x),v=n(1522),y={};function b(e){var t=e.allTimeTotal,n=e.weeklyTotal;return c().createElement("div",{className:"total_Downloads"},c().createElement("p",null,"Last Week Downloads: ",n),c().createElement("p",null,"Time Z Downloads: ",t))}function D(e){var t=e.packages,n=e.handleChart;return c().createElement("div",{className:"packages_list"},c().createElement("p",null,'"@dynamic-data" Packages: '),c().createElement("div",{className:"packages_list__scroll"},t.map((function(e){return c().createElement("p",{key:e.packageName,onClick:function(){return n(e)}},e.packageName.slice(13))}))))}function _(){return c().createElement("div",{className:"loading_screen"},c().createElement("span",{className:"loader"}),c().createElement("p",null,"Loading ..."))}y.styleTagTransform=k(),y.setAttributes=f(),y.insert=h().bind(null,"head"),y.domAPI=p(),y.insertStyleElement=E(),s()(v.Z,y),v.Z&&v.Z.locals&&v.Z.locals,n(3450);var S=n(3258),Z=n(441),N=n(5484),j=n(3131),T=n(5556),z=n(2655),C=n(3164),I=n(1573);const P=function(e){var t=e.chartData,n=e.handleChart,a=(0,r.useState)("weekly"),o=(0,l.Z)(a,2),m=o[0],i=o[1],s=(0,r.useState)(),d=(0,l.Z)(s,2),p=d[0],u=d[1],h=(0,r.useState)(),g=(0,l.Z)(h,2),f=g[0],w=g[1],E=(0,r.useState)(),x=(0,l.Z)(E,2),k=x[0],v=x[1];(0,r.useEffect)((function(){Date.parse(p)<Date.parse(f)?(v(),fetch("https://api.npmjs.org/downloads/range/".concat(p,":").concat(f,"/").concat(t.packageInfo.packageName)).then((function(e){return e.json()})).then((function(e){return v(e)}))):v()}),[p,f]),(0,r.useEffect)((function(){console.log(k)}),[k]);var y=function(e){var t=e.active,n=e.payload;return e.label,t?c().createElement("div",{className:"chart-tooltip"},c().createElement("div",{className:"chart_custom_tooltip"},c().createElement("span",null,"Day: ",n[0].payload.dateSpan),c().createElement("span",null,"Downloads: ",n[0].payload.totalDownloads))):null},b=function(e){var t=e.active,n=e.payload;return e.label,t?c().createElement("div",{className:"chart-tooltip"},c().createElement("div",{className:"chart_custom_tooltip"},c().createElement("span",null,"Day: ",n[0].payload.day),c().createElement("span",null,"Downloads: ",n[0].payload.downloads))):null};return c().createElement("div",{className:"chart"},c().createElement("div",{className:"arrow_border",onClick:function(){return n()}},c().createElement("i",{className:"arrow left"})),c().createElement("select",{className:"select",onChange:function(e){return function(e){i(e.target.value)}(e)}},[{value:"weekly",label:"Weekly Downloads"},{value:"custom",label:"Custom Downloads"}].map((function(e){return c().createElement("option",{value:e.value,key:e.label},e.label)}))),"weekly"===m?c().createElement(c().Fragment,null,c().createElement("div",{className:"downloadsTitle"},c().createElement("h1",null,"Package: ",t.packageInfo.packageName.slice(13)),c().createElement("p",null,"Time Z Downloads: ",t.packageInfo.allDownloads),c().createElement("p",null,"This week Downloads: ",t.packageInfo.weeklyDownloads)),c().createElement("div",{className:"chart_viev"},c().createElement(S.h,{width:"100%",height:"85%"},c().createElement(Z.w,{width:250,height:200,data:t.chartData,margin:{top:5,right:40,left:-10,bottom:10}},c().createElement(N.q,{strokeDasharray:"3 3"}),c().createElement(j.B,null),c().createElement(T.K,null),c().createElement(z.u,{content:c().createElement(y,null)}),c().createElement(C.B,{dataKey:"totalDownloads",height:20,stroke:"#8884d8"}),c().createElement(I.x,{dataKey:"totalDownloads",stroke:"#8884d8",name:"dateSpan"}))))):c().createElement(c().Fragment,null,c().createElement("div",{className:"downloadsTitle"},c().createElement("h1",null,"Package: ",t.packageInfo.packageName.slice(13)),c().createElement("p",null,"From:",c().createElement("input",{type:"date",onChange:function(e){return u(e.target.value)}})),c().createElement("p",null,"To:",c().createElement("input",{type:"date",onChange:function(e){return w(e.target.value)}}))),c().createElement("div",{className:"chart_viev"},k?c().createElement(S.h,{width:"100%",height:"85%"},c().createElement(Z.w,{width:250,height:200,data:k.downloads,margin:{top:5,right:40,left:-10,bottom:10}},c().createElement(N.q,{strokeDasharray:"3 3"}),c().createElement(j.B,null),c().createElement(T.K,null),c().createElement(z.u,{content:c().createElement(b,null)}),c().createElement(C.B,{dataKey:"downloads",height:20,stroke:"#8884d8"}),c().createElement(I.x,{dataKey:"downloads",stroke:"#8884d8",name:"dateSpan"}))):c().createElement(c().Fragment,null,c().createElement("div",{className:"notification"},c().createElement("p",null,"Specify Data Range !"))))))};var K=function(e){var t=e.size,n=e.data,i=(0,m.usePrifina)().onUpdate,s=(0,r.useState)([]),d=(0,l.Z)(s,2),p=d[0],u=d[1],h=(0,r.useState)([]),g=(0,l.Z)(h,2),f=g[0],w=g[1],E=(0,r.useState)([]),x=(0,l.Z)(E,2),k=x[0],v=x[1],y=(0,r.useState)([]),S=(0,l.Z)(y,2),Z=S[0],N=S[1],j=(0,r.useState)(),T=(0,l.Z)(j,2),z=T[0],C=T[1],I=(0,r.useState)(0),K=(0,l.Z)(I,2),O=K[0],R=K[1],B=(0,r.useState)(0),F=(0,l.Z)(B,2),W=F[0],q=F[1],A=(0,r.useState)([]),L=(0,l.Z)(A,2),U=L[0],X=L[1],G=(0,r.useState)(!1),H=(0,l.Z)(G,2),J=H[0],M=H[1],Q=(0,r.useState)(!1),V=(0,l.Z)(Q,2),Y=(V[0],V[1]),$=new Date,ee=$.setDate($.getDate()),te=new Date(ee).toISOString().split("T")[0],ne=t;void 0!==n&&n.hasOwnProperty("settings")&&"object"===(0,o.Z)(n.settings)&&n.settings.hasOwnProperty("size")&&n.settings.size.length>0&&(ne=n.settings.size);var ae=(0,r.useState)(ne),oe=(0,l.Z)(ae,2),le=(oe[0],oe[1]),re=function(e){console.log("Data Update",e),e.hasOwnProperty("settings")&&"object"===(0,o.Z)(e.settings)&&e.settings.hasOwnProperty("size")&&le(e.settings.size)};(0,r.useEffect)((function(){i("njCrPXWhDtZF345bpZ39rmf",re),fetch("https://registry.npmjs.com/-/v1/search?text=@dynamic-data&size=1000").then((function(e){return e.json()})).then((function(e){return u(e.objects)}))}),[]),(0,r.useEffect)((function(){p.forEach((function(e){fetch("https://api.npmjs.org/downloads/point/last-week/".concat(e.package.name)).then((function(e){return e.json()})).then((function(e){return w((function(t){return[].concat((0,a.Z)(t),[e])}))}))})),p.forEach((function(e){fetch("https://registry.npmjs.org/".concat(e.package.name)).then((function(e){return e.json()})).then((function(e){return N((function(t){return[].concat((0,a.Z)(t),[e])}))}))}))}),[p]),(0,r.useEffect)((function(){f.length===p.length&&f.forEach((function(e){q((function(t){return t+e.downloads}))}))}),[f]),(0,r.useEffect)((function(){k.length===p.length&&k.forEach((function(e){R((function(t){return t+e.downloads}))}))}),[k]),(0,r.useEffect)((function(){Z.length===p.length&&(console.log("packagesCreateData",Z),Z.forEach((function(e){var t=e.time.created.split("T")[0];fetch("https://api.npmjs.org/downloads/point/".concat(t,":").concat(te,"/").concat(e.name)).then((function(e){return e.json()})).then((function(e){return v((function(t){return[].concat((0,a.Z)(t),[e])}))}))})))}),[Z]),(0,r.useEffect)((function(){p.length===f.length&&p.length===k.length&&(X([]),console.log("data",p),console.log("weeklyDownloads",f),console.log("allTimeDownloads",k),f.forEach((function(e){var t={},n=k.findIndex((function(t){return t.package===e.package}));t.packageName=e.package,t.weeklyDownloads=e.downloads,t.allDownloads=k[n].downloads,t.allDownloadsStartRange=k[n].start,t.allDownloadsEndRange=k[n].end,t.allDownloadsRange="".concat(k[n].start," / ").concat(k[n].end),console.log(),X((function(e){return[].concat((0,a.Z)(e),[t])}))})))}),[f,k]),(0,r.useEffect)((function(){p.length===U.length&&U.length>0&&setTimeout((function(){M(!0)}),100)}),[U]);var ce=function(e){if(e){var t=e.packageName,n=e.allDownloadsStartRange;console.log(t,n);var a=new Date(n),o=a.setDate(a.getDate()-(a.getDay()+6)%7),l=new Date(o).toISOString().split("T")[0];fetch("https://api.npmjs.org/downloads/range/".concat(l,":").concat(te,"/").concat(t)).then((function(e){return e.json()})).then((function(t){return me(t,e)}))}else C();Y((function(e){return!e}))},me=function(e,t){console.log(e);for(var n=e.downloads,a=[],o=function(e){var t={},o=n.slice(e,e+7),l=0;o.forEach((function(e){l+=e.downloads})),t.totalDownloads=l,t.dateSpan="".concat(o[0].day," / ").concat(o[o.length-1].day),a.push(t)},l=0;l<n.length;l+=7)o(l);var r={packageInfo:t,package:e.package,chartData:a};console.log(r),C(r)};return c().createElement("div",{className:"container"},J?c().createElement("div",null,z&&c().createElement(P,{chartData:z,handleChart:ce}),c().createElement(b,{allTimeTotal:O,weeklyTotal:W}),c().createElement("hr",null),c().createElement(D,{packages:U,handleChart:ce})):c().createElement(_,null))};K.defaultProps={size:"small"};const O=K;var R=n(953),B=document.getElementById("root");(0,R.createRoot)(B).render(c().createElement(O,null))},1522:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(9601),o=n.n(a),l=n(2609),r=n.n(l)()(o());r.push([e.id,'.container{width:300px;height:300px;border:1px solid black;border-radius:10px;margin:10px}.notification p{text-decoration:underline}.loading_screen{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:30px;width:100%;height:100%}.loading_screen p{padding-top:20px;font-size:20px;font-weight:600}.total_Downloads{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;height:70px;width:100%;padding-top:25px}.total_Downloads p{font-size:20px;font-weight:600}.select{width:150px;position:absolute;top:25px;left:25%}.packages_list{display:flex;flex-direction:column;justify-content:center;align-items:center;height:190px;width:100%;gap:10px;padding-bottom:10px}.packages_list p{font-size:20px;font-weight:600}.packages_list__scroll{overflow:auto;height:170px;width:90%;display:flex;flex-direction:column}.packages_list__scroll p{padding:7px 0px 7px 15px}.packages_list__scroll p:hover{background-color:#afafaf}.chart{position:absolute;width:298px;height:298px;background-color:white;border-radius:10px;padding-top:10px;display:flex;flex-direction:column;gap:10px}.chart .downloadsTitle{display:flex;flex-direction:column;justify-content:center;align-items:center;height:35%;padding-top:50px}.chart .downloadsTitle h1{font-size:18px;font-weight:600;margin-bottom:5px}.chart .downloadsTitle p{font-size:16px;font-weight:400}.chart_viev{display:flex;justify-content:center;align-items:center;height:65%;width:100%;padding-bottom:5px}.chart_viev p:nth-child(1){padding-bottom:10px;font-size:20px;font-weight:500}.chart_custom_tooltip{display:flex;flex-direction:column;padding:10px;background-color:rgba(51,51,51,0.3)}.arrow{border:solid black 1px;border-width:0 2px 2px 0;display:inline-block;padding:3px;margin-left:2px}.arrow_border{content:"";position:absolute;display:flex;justify-content:center;align-items:center;margin:5px 12px;height:30px;width:31px;border:1px solid black;border-radius:50%}.left{transform:rotate(135deg)}.loader{color:#000;font-size:10px;width:1em;height:1em;border-radius:50%;position:relative;text-indent:-9999em;animation:mulShdSpin 1.3s infinite linear;transform:translateZ(0)}@keyframes mulShdSpin{0%,100%{box-shadow:0 -3em 0 0.2em, \r 2em -2em 0 0em, 3em 0 0 -1em, \r 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 -1em, -3em 0 0 -1em, \r -2em -2em 0 0}12.5%{box-shadow:0 -3em 0 0, 2em -2em 0 0.2em, \r 3em 0 0 0, 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 -1em, -3em 0 0 -1em, \r -2em -2em 0 -1em}25%{box-shadow:0 -3em 0 -0.5em, \r 2em -2em 0 0, 3em 0 0 0.2em, \r 2em 2em 0 0, 0 3em 0 -1em, \r -2em 2em 0 -1em, -3em 0 0 -1em, \r -2em -2em 0 -1em}37.5%{box-shadow:0 -3em 0 -1em, 2em -2em 0 -1em,\r 3em 0em 0 0, 2em 2em 0 0.2em, 0 3em 0 0em, \r -2em 2em 0 -1em, -3em 0em 0 -1em, -2em -2em 0 -1em}50%{box-shadow:0 -3em 0 -1em, 2em -2em 0 -1em,\r 3em 0 0 -1em, 2em 2em 0 0em, 0 3em 0 0.2em, \r -2em 2em 0 0, -3em 0em 0 -1em, -2em -2em 0 -1em}62.5%{box-shadow:0 -3em 0 -1em, 2em -2em 0 -1em,\r 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 0, \r -2em 2em 0 0.2em, -3em 0 0 0, -2em -2em 0 -1em}75%{box-shadow:0em -3em 0 -1em, 2em -2em 0 -1em, \r 3em 0em 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 0, -3em 0em 0 0.2em, -2em -2em 0 0}87.5%{box-shadow:0em -3em 0 0, 2em -2em 0 -1em, \r 3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, \r -2em 2em 0 0, -3em 0em 0 0, -2em -2em 0 0.2em}}\n',""]);const c=r}}]);